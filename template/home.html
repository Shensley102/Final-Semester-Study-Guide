<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Nurse Success Study Hub - Interactive Quiz Application">
  <title>Nurse Success Study Hub</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/home-style.css">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Vercel Analytics -->
  <script defer src="https://cdn.vercel-analytics.com/v1/web.js"></script>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="hub-header">
      <h1>üè• Nurse Success Study Hub</h1>
      <p class="tagline">Master your nursing knowledge with targeted study modules</p>
    </header>

    <!-- Search Bar -->
    <div class="search-container">
      <input 
        type="text" 
        id="searchInput" 
        class="search-bar" 
        placeholder="Search study categories..."
      >
    </div>

    <!-- Categories Grid -->
    <main class="categories-grid" id="categoriesContainer">
      <!-- Categories will be loaded here by JavaScript -->
    </main>

    <!-- Footer -->
    <footer class="hub-footer">
      <p>&copy; 2025 Nurse Success Study Hub. Study smarter, succeed faster.</p>
    </footer>
  </div>

  <script>
    const categoryColors = {
      'Patient Care Management': '#FF6B6B',
      'HESI': '#4ECDC4',
      'Nursing Certifications': '#45B7D1',
      'Pharmacology': '#96CEB4'
    };

    const categoryIcons = {
      'Patient Care Management': 'üë•',
      'HESI': 'üìã',
      'Nursing Certifications': 'üèÜ',
      'Pharmacology': 'üíä'
    };

    // Categories that skip the middle category page and go straight to quiz
    const skipCategoryPage = ['Patient Care Management', 'HESI'];

    async function loadCategories() {
      try {
        const res = await fetch('/api/categories');
        if (!res.ok) throw new Error('Failed to load categories');
        
        const categories = await res.json();
        const container = document.getElementById('categoriesContainer');
        
        container.innerHTML = Object.entries(categories).map(([key, data]) => {
          const icon = categoryIcons[key] || 'üìö';
          const color = categoryColors[key] || '#2f61f3';
          
          // Determine the link based on whether we skip the category page
          let href;
          if (skipCategoryPage.includes(key)) {
            href = `/quiz?category=${encodeURIComponent(key)}`;
          } else {
            href = `/category/${encodeURIComponent(key)}`;
          }
          
          // Special handling for Nursing Certifications - use image instead of icon
          if (key === 'Nursing Certifications') {
            return `
              <a href="${href}" class="category-card category-card-image" style="--accent-color: ${color}">
                <img src="/static/Nursing_Certifications_Image.png" alt="Nursing Certifications" class="category-card-img">
                <div class="card-arrow">‚Üí</div>
              </a>
            `;
          }
          
          return `
            <a href="${href}" class="category-card" style="--accent-color: ${color}">
              <div class="category-icon">${icon}</div>
              <h2>${key}</h2>
              <div class="card-arrow">‚Üí</div>
            </a>
          `;
        }).join('');
      } catch (error) {
        console.error('Error loading categories:', error);
        document.getElementById('categoriesContainer').innerHTML = `
          <div style="grid-column: 1/-1; padding: 40px; text-align: center; color: var(--danger);">
            <p>Error loading categories. Please refresh the page.</p>
          </div>
        `;
      }
    }

    // Search functionality
    document.getElementById('searchInput').addEventListener('input', (e) => {
      const searchTerm = e.target.value.toLowerCase();
      const cards = document.querySelectorAll('.category-card');
      
      cards.forEach(card => {
        const title = card.querySelector('h2')?.textContent.toLowerCase() || '';
        const isImageCard = card.classList.contains('category-card-image');
        const matchesSearch = title.includes(searchTerm) || (isImageCard && 'nursing certifications'.includes(searchTerm));
        card.style.display = matchesSearch ? '' : 'none';
      });
    });

    // Load categories on page load
    loadCategories();
  </script>
</body>
</html>
